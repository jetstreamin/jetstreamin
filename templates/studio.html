<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jetstreamin Sermon Studio</title>
    <style>
        body { font-family: monospace; background-color: #1a1a1a; color: #00ff00; margin: 2em; }
        h1 { border-bottom: 1px solid #00ff00; }
        textarea { width: 100%; height: 250px; background-color: #000; color: #00ff00; border: 1px solid #00ff00; font-size: 1.1em; margin-bottom: 1em; }
        button { background-color: #00ff00; color: #000; border: none; padding: 10px 20px; cursor: pointer; font-size: 1em; margin-top: 10px; }
        #status { margin-top: 20px; white-space: pre-wrap; }
        #video-link { color: #ffff00; }
        .pipeline-choice { margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Sermon Studio (Cyphermorph Interface)</h1>
    <p>AI-generated sermon text below (via ATM). Edit as needed. Use "---" to separate scenes.</p>
    <form id="sermon-form">
        <textarea id="sermon_text" name="sermon_text">{{ sermon_text }}</textarea>
        
        <div class="pipeline-choice">
            <strong>Select Pipeline:</strong>
            <label><input type="radio" name="pipeline" value="ffmpeg" checked> Classic (FFmpeg Text)</label>
            <label><input type="radio" name="pipeline" value="veo"> Advanced (Veo AI Video)</label>
        </div>
        
        <button type="submit">Generate Sermon Video</button>
    </form>
    <div id="status"></div>

    <script>
        document.getElementById('sermon-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = 'Generating... Please wait.';

            const formData = new FormData(this);
            const response = await fetch('/generate', {
                method: 'POST',
                body: formData
            });

            const result = await response.json();
            if (result.status === 'success') {
                if (result.pipeline === 'veo') {
                    statusDiv.innerHTML = `Veo Pipeline Simulation Complete:\n${result.message}\nVideo would be available at: <a id="video-link" href="${result.video_url}" target="_blank">${result.video_url}</a>`;
                } else {
                    statusDiv.innerHTML = `FFmpeg Video Generated! <a id="video-link" href="/videos/${result.file}" target="_blank">Click to view</a>`;
                }
            } else {
                statusDiv.textContent = 'Error generating video.';
            }
        });
    </script>
</body>
</html>
